<!DOCTYPE html>
<html>
<head>
	<title>Starlist</title>
	<meta http-equiv="content-type" content="text/html">
	<meta charset="utf-8">

	<link href='https://fonts.googleapis.com/css?family=Noto Sans' rel='stylesheet'>
	<link rel="stylesheet" href="public/lower.css">

</head>
<body>
	<main>
		<div class="wrapper">

			<div class="header anim header-0">

				<img id="PICTO" class="picto"></img>

				<div class="filler">
					<div class="title">
						<div id="HBACK" class="hbg anim hbg-0"></div>
						<div id="EVENT" class="text anim text-0"></div>
						<!-- <img id="LOGO" class="flag anim flag-0"></img> -->
					</div>

					<div class="subtitle">
						<div id="SBACK" class="sbg anim sbg-0"></div>
						<div id="PHASE" class="text anim text-0"></div>
					</div>
				</div>
			</div>
			

			<div class="veil">
				<div id="BACK_1" class="bkgr anim bkgr-0"></div>
				<img id="FLAG_1" class="flag anim flag-0"></img>
				<div id="NAME_1" class="text anim text-0"></div>
				<div id="TIME_1" class="numb anim numb-0"></div>
			</div>
			
			<div class="veil">
				<div id="BACK_2" class="bkgr anim bkgr-0"></div>
				<img id="FLAG_2" class="flag anim flag-0"></img>
				<div id="NAME_2" class="text anim text-0"></div>
				<div id="TIME_2" class="numb anim numb-0"></div>
			</div>

			<div class="veil">
				<div id="BACK_3" class="bkgr anim bkgr-0"></div>
				<img id="FLAG_3" class="flag anim flag-0"></img>
				<div id="NAME_3" class="text anim text-0"></div>
				<div id="TIME_3" class="numb anim numb-0"></div>
			</div>

			<div class="veil">
				<div id="BACK_4" class="bkgr anim bkgr-0"></div>
				<img id="FLAG_4" class="flag anim flag-0"></img>
				<div id="NAME_4" class="text anim text-0"></div>
				<div id="TIME_4" class="numb anim numb-0"></div>
			</div>

			<div class="veil">
				<div id="BACK_5" class="bkgr anim bkgr-0"></div>
				<img id="FLAG_5" class="flag anim flag-0"></img>
				<div id="NAME_5" class="text anim text-0"></div>
				<div id="TIME_5" class="numb anim numb-0"></div>
			</div>
		</div>
	</main>
</body>

<script>

	const dataReplicant = nodecg.Replicant("../../athletics/graphics/startlist.html", 'main');

	const elems = document.body.getElementsByClassName("anim");

	dataReplicant.on('change', (newValue, oldValue) => {

		newValue.data.forEach(function (element) {

			Object.keys(element).forEach(function (atribute){
				
				if (atribute == 'id') {
				}

				else if (atribute == "value")
					document.getElementById(element.id).innerHTML = element[atribute];

				else
					document.getElementById(element.id).setAttribute(atribute, element[atribute]);
			});

			for (let i = 0; i < elems.length; i++) {

				let classes = elems[i].className;
				let mainClass = classes.split(' ')[0];
				let oldState = classes.split(' ')[2];
				let newState = mainClass + '-' + newValue.template.command;

				elems[i].classList.replace(oldState, newState);
			};
		});
	});

/*
	document.writeln('<div id="animation-1" class="animation">');
		document.writeln('	<div class="color2">/</div>');
		document.writeln('	<div class="color1 light mask">');
		*/
</script>
</html>